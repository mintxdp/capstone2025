#!/usr/bin/env bash
# ========================================
# System Update and Cleanup Tool
# Part of your command suite
# ========================================
# Determine the base directory for libraries

set -euo pipefail

# Load shared library resolver
if [ -f "/usr/local/lib/tool/loader.sh" ]; then
    source "/usr/local/lib/tool/loader.sh"
else
    SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
    source "$SCRIPT_DIR/../lib/loader.sh"
fi


# ----------------------------------------
# Main Update Function
# ----------------------------------------
perform_update() {
  log_info "Starting system update..."

  if ! command -v apt-get &>/dev/null; then
    log_error "apt-get not found. This script supports Debian/Ubuntu systems only."
    exit 1
  fi

  sudo apt-get update -y
  sudo apt-get upgrade -y
  sudo apt-get dist-upgrade -y
  sudo apt-get autoremove -y
  sudo apt-get autoclean -y

  log_info "System packages updated and cleaned successfully."
}

# ----------------------------------------
# Run Script
# ----------------------------------------
confirm "This will update and clean your system. Proceed?"
perform_update
log_info "âœ… Update completed successfully."

